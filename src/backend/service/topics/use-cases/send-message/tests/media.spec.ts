/// <reference types="jest-extended" />
import { saveMedia } from "../media";
import { expect, describe, test } from "vitest";

const PROJECT_ROOT =
  "/Users/joohom/Documents/Projects/SideProjects/tinode/tinode-clone/tinode-clone-3";

describe("Topic media", () => {
  test("save media", async () => {
    const b64 = `data:image/png;base64,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`;
    const savedResult = await saveMedia(
      {
        filename: "mickey.png",
        base64: b64,
        type: "message.picture",
      },
      {
        projectRoot: PROJECT_ROOT,
      }
    );
    if (savedResult.isErr()) {
      throw savedResult.error;
    }
    console.log(savedResult);
  });
});
